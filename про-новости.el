;;; –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏.el --- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –¥–∞–π–¥–∂–µ—Å—Ç—ã –∏ AI-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–∞ Emacs -*- lexical-binding: t -*-
;;; Commentary:
;; 
;; –ú–æ–¥—É–ª—å ‚Äú–ü—Ä–æ-–ù–æ–≤–æ—Å—Ç–∏‚Äù ‚Äî –≤–∞—à –±—ã—Å—Ç—Ä—ã–π, —É–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –¥–∞–π–¥–∂–µ—Å—Ç–∞–º –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ
;; –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –ª–µ–Ω—Ç –ø—Ä—è–º–æ –≤ Emacs.
;;
;; –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
;;  - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å–±–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π (–±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)
;;  - –ì–æ—Ç–æ–≤—ã–µ –º–∞–∫—Ä–æ—Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ —Ç–µ–º–∞—Ç–∏–∫–∞–º –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ä–µ–∑–∞–º
;;  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å gptel (AI): –ø–æ—è—Å–Ω–µ–Ω–∏—è, –∞–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤, –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç—á—ë—Ç—ã
;;  - –ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤, –ø–æ–∏—Å–∫–∏ —Ç–µ–º, –∫–∞—Ä—Ç—ã —Ç–µ–º
;;  - ‚Äú–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏‚Äù ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ–º –∏ —Å–ª–æ–≤
;;  - –ú–µ–Ω—é –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤: –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –ø–∞—Ä—É –∫–ª–∏–∫–æ–≤!
;;
;;; Code:

(require 'cl-lib)
(require 'subr-x)
(require 'seq)
(require 'elfeed)
(require 'gptel)

(defgroup –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏ nil
  "–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –¥–∞–π–¥–∂–µ—Å—Ç—ã –∏ AI-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –ª–µ–Ω—Ç."
  :group 'applications)

(defcustom –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–ª–æ–≥-dir
  (expand-file-name "–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–ª–æ–≥/" user-emacs-directory)
  "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π."
  :type 'directory)

(defvar-local –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ª–æ–≥-–∫–æ–Ω—Ç–µ–∫—Å—Ç nil
  "–í—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (plist) –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ AI-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.")

;;;; === –ú–∞–∫—Ä–æ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–π: –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –∏ –º–∞–≥–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ===

(defmacro –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π (–∏–º—è docstring &rest plist)
  "–°–æ–∑–¥–∞—ë—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –Ω–æ–≤–æ—Å—Ç–Ω—É—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è AI-–¥–∞–π–¥–∂–µ—Å—Ç–æ–≤ —Å –Ω–∞–±–æ—Ä–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
IM–Ø ‚Äî –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏; DOCSTRING ‚Äî —Å—Ç—Ä–æ–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
PLIST ‚Äî :—á–∞—Å–æ–≤ N, :–º–∞–∫—Å–∏–º—É–º M, :–ø—Ä–æ–º–ø—Ç PROMPT, :—Å—Å—ã–ª–∫–∏ T, :—Ñ–∏–ª—å—Ç—Ä REGEXP.
–õ—é–±–∞—è –∫–æ–º–∞–Ω–¥–∞, —Å–æ–∑–¥–∞–Ω–Ω–∞—è —ç—Ç–æ—Ç –º–∞–∫—Ä–æ—Å–æ–º ‚Äî –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –æ–±—â–µ–º –º–µ–Ω—é."
  `(defun ,–∏–º—è ()
     ,docstring
     (interactive)
     (let* ((—á–∞—Å–æ–≤    ,(plist-get plist :—á–∞—Å–æ–≤))
            (–º–∞–∫—Å–∏–º—É–º ,(plist-get plist :–º–∞–∫—Å–∏–º—É–º))
            (–ø—Ä–æ–º–ø—Ç   ,(or (plist-get plist :–ø—Ä–æ–º–ø—Ç) docstring))
            (—Å—Å—ã–ª–∫–∏   ,(plist-get plist :—Å—Å—ã–ª–∫–∏))
            (—Ñ–∏–ª—å—Ç—Ä   ,(plist-get plist :—Ñ–∏–ª—å—Ç—Ä)))
       (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–≤—ã–±—Ä–∞—Ç—å-–∏-–æ—Ç–ø—Ä–∞–≤–∏—Ç—å —á–∞—Å–æ–≤ —Ñ–∏–ª—å—Ç—Ä –º–∞–∫—Å–∏–º—É–º –ø—Ä–æ–º–ø—Ç —Å—Å—ã–ª–∫–∏))))

;;; === –ì–æ—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –î–∏–∞–ª–µ–∫—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ ===

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–¥–∏–∞–ª–µ–∫—Ç–∏—á–µ—Å–∫–∏–π-–∞–Ω–∞–ª–∏–∑
 "–î–∏–∞–ª–µ–∫—Ç–∏—á–µ—Å–∫–∏–π AI-–∞–Ω–∞–ª–∏–∑: –≤—ã—è–≤–∏—Ç—å –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –≤ –Ω–æ–≤–æ—Å—Ç—è—Ö, –æ–ø–∏—Å–∞—Ç—å –∏—Ö, –Ω–∞–π—Ç–∏ —Å–∏–Ω—Ç–µ–∑."
 :—á–∞—Å–æ–≤ 24
 :–º–∞–∫—Å–∏–º—É–º 20
 :–ø—Ä–æ–º–ø—Ç "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π –≤ –¥—É—Ö–µ –¥–∏–∞–ª–µ–∫—Ç–∏–∫–∏: –Ω–∞–π–¥–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è, –æ–ø–∏—à–∏ –∏—Ö –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö —Ç–µ–∑–∏—Å–∞-–∞–Ω—Ç–∏—Ç–µ–∑–∏—Å–∞, –ø—Ä–µ–¥–ª–æ–∂–∏ –≤–æ–∑–º–æ–∂–Ω—ã–π —Å–∏–Ω—Ç–µ–∑ –∏ —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–π —Ä–∞–∑–≤–∏—Ç–∏–µ —Å–æ–±—ã—Ç–∏–π. –§–æ—Ä–º–∞—Ç–∏—Ä—É–π –æ—Ç—á—ë—Ç –∫–∞–∫ –∫—Ä–∞—Ç–∫–∏–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫ –¥–ª—è —ç–∫—Å–ø–µ—Ä—Ç–∞."
 :—Å—Å—ã–ª–∫–∏ t)

;;;; === –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å–±–æ—Ä –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π ===

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ø–æ–ª—É—á–∏—Ç—å-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (—Å–µ–∫—É–Ω–¥ on-chunk on-done)
  "–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ –∑–∞ –°–ï–ö–£–ù–î —á–µ—Ä–µ–∑ elfeed, –¥–∞–π on-chunk –∫–∞–∂–¥–æ–º—É —á–∞–Ω–∫—É, –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ on-done –≤—Å–µ–º—É —Å–ø–∏—Å–∫—É."
  (if (not (and (boundp 'elfeed-db-entries)
                (hash-table-p elfeed-db-entries)))
      (progn
        (message "–ë–∞–∑–∞ –Ω–æ–≤–æ—Å—Ç–µ–π Elfeed –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –∏–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞! –°–Ω–∞—á–∞–ª–∞ –≤—ã–∑–æ–≤–∏—Ç–µ M-x elfeed.")
        (funcall on-done nil))
    (let ((–Ω–æ–≤–æ—Å—Ç–∏ (cl-remove-if-not
                    (lambda (e)
                      (< (- (float-time) (elfeed-entry-date e)) —Å–µ–∫—É–Ω–¥))
                    (hash-table-values elfeed-db-entries))))
      (message "–°–æ–±—Ä–∞–Ω–æ %d –Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥." (length –Ω–æ–≤–æ—Å—Ç–∏))
      (let ((not-entries (cl-remove-if #'elfeed-entry-p –Ω–æ–≤–æ—Å—Ç–∏)))
        (when not-entries
          (message "–í–ù–ò–ú–ê–ù–ò–ï: –ù–∞–π–¥–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ —Ç–∏–ø–∞ elfeed-entry: %S" not-entries)))
      (setq –Ω–æ–≤–æ—Å—Ç–∏ (sort –Ω–æ–≤–æ—Å—Ç–∏ (lambda (a b) (> (elfeed-entry-date a) (elfeed-entry-date b)))))
      (when (null –Ω–æ–≤–æ—Å—Ç–∏)
        (setq –Ω–æ–≤–æ—Å—Ç–∏ (sort (hash-table-values elfeed-db-entries)
                            (lambda (a b) (> (elfeed-entry-date a) (elfeed-entry-date b)))))
        (message "–ó–∞ –ø–µ—Ä–∏–æ–¥ –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–µ—Ç. –í–∑—è–ª –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ: %d —à—Ç—É–∫." (length –Ω–æ–≤–æ—Å—Ç–∏)))
      (if (null –Ω–æ–≤–æ—Å—Ç–∏)
          (progn
            (message "–í –±–∞–∑–µ Elfeed –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π –≤–æ–æ–±—â–µ! –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∏–¥—ã: M-x elfeed-update")
            (funcall on-done nil))
        (run-at-time 0 nil
                     (lambda ()
                       (let ((result (if on-chunk
                                         (progn
                                           (let ((–æ—Ä–∏–≥–∏–Ω–∞–ª (copy-sequence –Ω–æ–≤–æ—Å—Ç–∏))) ;; –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–ø–∏—é –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞
                                             (while –Ω–æ–≤–æ—Å—Ç–∏
                                               (funcall on-chunk (cl-subseq –Ω–æ–≤–æ—Å—Ç–∏ 0 (min 20 (length –Ω–æ–≤–æ—Å—Ç–∏))))
                                               (setq –Ω–æ–≤–æ—Å—Ç–∏ (nthcdr 20 –Ω–æ–≤–æ—Å—Ç–∏)))
                                             –æ—Ä–∏–≥–∏–Ω–∞–ª))
                                       –Ω–æ–≤–æ—Å—Ç–∏)))
                         (message "–ü–µ—Ä–µ–¥–∞–Ω–æ –≤ on-done: %d –Ω–æ–≤–æ—Å—Ç–µ–π." (length result))
                         (funcall on-done result))))))))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å (lst regexp &optional exclude-list)
  "–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å LST –ø–æ REGEXP (–∏–ª–∏ –≤—Å–µ), —É–¥–∞–ª–∏—Ç—å –≤—Å–µ, –≥–¥–µ –µ—Å—Ç—å EXCLUDE-LIST."
  (let* ((exclude (or exclude-list '("–ª–∞–π—Ñ—Ö–∞–∫" "—Å–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ" "—Å–∫–∏–¥–∫–∏" "Clickbait")))
         (result (cl-remove-if
                  (lambda (x)
                    (or (and regexp (not (string-match-p regexp (elfeed-entry-title x))))
                        (cl-some (lambda (s) (string-match-p (regexp-quote s) (elfeed-entry-title x))) exclude)))
                  lst)))
    (if (null result)
        (progn
          (message "–ü–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏ (%s) –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å. –ü—Ä–æ–±—É—é –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π." (string-join exclude ", "))
          (cl-remove-if
           (lambda (x)
             (and regexp (not (string-match-p regexp (elfeed-entry-title x)))))
           lst))
      result)))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ø–∞–∫–µ—Ç (–Ω–æ–≤–æ—Å—Ç–∏ –º–∞–∫—Å–∏–º—É–º)
  "–û–±—Ä–µ–∑–∞—Ç—å –ù–û–í–û–°–¢–ò –¥–æ –ú–ê–ö–°–ò–ú–£–ú ‚Äî —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ MAX."
  (seq-take –Ω–æ–≤–æ—Å—Ç–∏ (or –º–∞–∫—Å–∏–º—É–º 30)))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--—Ñ–æ—Ä–º–∞—Ç (lst &optional links)
  "–§–æ—Ä–º–∞—Ç —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è AI –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."
  (mapconcat (lambda (x)
               (if links (format "- %s (%s)" (car x) (cdr x))
                 (format "- %s" (car x))))
             lst "\n"))

;;;; === –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –≤ gptel (AI) ===
(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–æ—Ç–ø—Ä–∞–≤–∏—Ç—å-via-gptel (–∏—Ç–æ–≥ –ø—Ä–æ–º–ø—Ç links)
  (unless (and (listp –∏—Ç–æ–≥)
               (stringp –ø—Ä–æ–º–ø—Ç))
    (error "[–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏] –ù–ï–í–ï–†–ù–´–ï –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–æ—Ç–ø—Ä–∞–≤–∏—Ç—å-via-gptel: –∏—Ç–æ–≥=%S –ø—Ä–æ–º–ø—Ç=%S" –∏—Ç–æ–≥ –ø—Ä–æ–º–ø—Ç))
  (message "[–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏] –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ AI Tunnel...")
  (let* ((—Å—Ç—Ä–æ–∫–∞-—Å–ø–∏—Å–∫–∞
          (mapconcat (lambda (entry)
                       (if (consp entry)
                           (format "- %s (%s)" (car entry) (cdr entry))
                         (format "- %s" (format "%s" entry))))
                     –∏—Ç–æ–≥
                     "\n"))
         (–ø–æ–ª–Ω—ã–π-–ø—Ä–æ–º–ø—Ç
          (if (and –ø—Ä–æ–º–ø—Ç (not (string-empty-p –ø—Ä–æ–º–ø—Ç)))
              (concat –ø—Ä–æ–º–ø—Ç "\n\n" —Å—Ç—Ä–æ–∫–∞-—Å–ø–∏—Å–∫–∞)
            —Å—Ç—Ä–æ–∫–∞-—Å–ø–∏—Å–∫–∞)))
    (message "[–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏] –ó–∞–ø—Ä–æ—Å –≤ AI: %S" –ø–æ–ª–Ω—ã–π-–ø—Ä–æ–º–ø—Ç)
    (let ((buf (get-buffer-create "*AI News Answer*")))
      (with-current-buffer buf
        (erase-buffer)
        (insert "#+TITLE: AI News Summary\n\n* Reasoning:\n<<waiting>>\n\n* Response:\n–ñ–¥–∏—Ç–µ, –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è (streaming)...\n\n"))
      (pop-to-buffer buf)
      (message "[–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏] –û–∫–Ω–æ —Å –æ—Ç–≤–µ—Ç–æ–º AI –æ—Ç–∫—Ä—ã—Ç–æ, –∂–¥–∏—Ç–µ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞.")
      (gptel-request
       —Å—Ç—Ä–æ–∫–∞-—Å–ø–∏—Å–∫–∞  ;; –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç: –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç (—Å–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π)
       :system –ø—Ä–æ–º–ø—Ç  ;; –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è AI
       :stream t  ;; –í–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∏–º–∏–Ω–≥, –µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
       :callback (lambda (response info)  ;; Callback —Å response –∏ info
                   (if (not response)
                       (let ((err (plist-get info :status)))
                         (message "[–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏][–û–®–ò–ë–ö–ê] AI Tunnel: %S" err))
                     (message "[–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏] –ß–∞–Ω–∫ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—É—á–µ–Ω –æ—Ç AI Tunnel.")
                     (with-current-buffer buf
                       (save-excursion
                         (let ((content (pcase response
                                          ((pred stringp) response)
                                          (`(reasoning . ,val)
                                           (when (stringp val)
                                             (save-excursion
                                               (goto-char (point-min))
                                               (when (search-forward "* Reasoning:" nil t)
                                                 (forward-line 1)
                                                 (delete-region (point) (line-end-position))
                                                 (insert val)))
                                             nil))  ;; –ù–µ –≤—Å—Ç–∞–≤–ª—è–µ–º –≤ –æ—Å–Ω–æ–≤–Ω–æ–π response
                                          (`(content . ,val) (if (stringp val) val (format "%S" val)))
                                          ((pred listp)
                                           (or (alist-get 'content response)
                                               (let ((reas (alist-get 'reasoning response)))
                                                 (when reas
                                                   (save-excursion
                                                     (goto-char (point-min))
                                                     (when (search-forward "* Reasoning:" nil t)
                                                       (forward-line 1)
                                                       (delete-region (point) (line-end-position))
                                                       (insert (if (stringp reas) reas (format "%S" reas)))))
                                                   nil))
                                               (format "%S" response)))
                                          (_ (format "%S" response)))))
                           (when (stringp content)
                             (goto-char (point-max))
                             (insert content)))))))))))


;;;; === –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (org) ===

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å (–∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–æ–º–ø—Ç –æ—Ç–≤–µ—Ç meta)
  "–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏–∑ –≤ org-—Ñ–∞–π–ª –∏—Å—Ç–æ—Ä–∏–∏ (–ó–ê–ì–û–õ–û–í–ö–ò, –ü–†–û–ú–ü–¢, –û–¢–í–ï–¢, META)."
  (let* ((scenario-name (or (car –∑–∞–≥–æ–ª–æ–≤–∫–∏) "news"))
         (date (format-time-string "%Y-%m-%d"))
         (log-dir (file-name-as-directory –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–ª–æ–≥-dir))
         (file (expand-file-name (format "%s-%s.org" scenario-name date) log-dir)))
    (unless (file-directory-p log-dir)
      (make-directory log-dir t))
    (with-temp-buffer
      (insert (format "#+TITLE: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ %s (%s)\n\n" scenario-name date))
      (insert "* –ó–∞–≥–æ–ª–æ–≤–∫–∏:\n" (mapconcat #'car –∑–∞–≥–æ–ª–æ–≤–∫–∏ "\n") "\n\n")
      (when –ø—Ä–æ–º–ø—Ç
        (insert "* AI-–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:\n" –ø—Ä–æ–º–ø—Ç "\n\n"))
      (when meta (insert "* META:\n" (format "%S" meta) "\n\n"))
      (insert "* –û—Ç–≤–µ—Ç AI:\n" –æ—Ç–≤–µ—Ç "\n")
      (write-file file))
    file))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–ª–æ–≥-—Ñ–∞–π–ª—ã (&optional —Ç–æ–ª—å–∫–æ-—Å—Ü–µ–Ω)
  "–°–ø–∏—Å–æ–∫ –ª–æ–≥–æ–≤ –∏—Å—Ç–æ—Ä–∏–∏, –º–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–µ–º."
  (let* ((dir (file-name-as-directory –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–ª–æ–≥-dir))
         (files (when (file-directory-p dir)
                  (directory-files dir t "\\.org\\'"))))
    (cl-loop for f in files
             when (string-match "\\([^/]+\\)-\\([0-9][0-9][0-9][0-9]-[0-9]+-[0-9]+\\)\\.org\\'" f)
             for scen = (match-string 1 f)
             for date = (match-string 2 f)
             if (or (not —Ç–æ–ª—å–∫–æ-—Å—Ü–µ–Ω) (string= —Ç–æ–ª—å–∫–æ-—Å—Ü–µ–Ω scen))
             collect (cons (format "%s | %s" scen date) f))))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–≤—ã–±—Ä–∞—Ç—å ()
  "–û—Ç–∫—Ä—ã—Ç—å –ª–æ–≥–∏ –∏—Å—Ç–æ—Ä–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏."
  (interactive)
  (let* ((lst (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–ª–æ–≥-—Ñ–∞–π–ª—ã))
         (choice (completing-read "–õ–æ–≥–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: " (mapcar #'car lst) nil t)))
    (when-let ((file (cdr (assoc choice lst))))
      (find-file file)
      (message "–û—Ç–∫—Ä—ã—Ç: %s" (abbreviate-file-name file)))))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–ø–æ—Å–ª–µ–¥–Ω–∏–µ (n)
  "–û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π N –ª–æ–≥–æ–≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏."
  (interactive "n–°–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤ –ø–æ–∫–∞–∑–∞—Ç—å: ")
  (let* ((lst (sort (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–ª–æ–≥-—Ñ–∞–π–ª—ã)
                    (lambda (a b) (string> (cdr a) (cdr b)))))
         (sel (cl-subseq lst 0 (min n (length lst)))))
    (dolist (x sel)
      (find-file-other-window (cdr x))
      (message "–û—Ç–∫—Ä—ã—Ç: %s" (car x)))))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/diff ()
  "–°—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞ –ª–æ–≥–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (–≤–∏–∑—É–∞–ª—å–Ω—ã–π diff)."
  (interactive)
  (let* ((lst (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–ª–æ–≥-—Ñ–∞–π–ª—ã))
         (lst-names (mapcar #'car lst))
         (a (cdr (assoc (completing-read "–ü–µ—Ä–≤—ã–π –ª–æ–≥ (—Å—Ç–∞—Ä—ã–π): " lst-names nil t) lst)))
         (b (cdr (assoc (completing-read "–í—Ç–æ—Ä–æ–π –ª–æ–≥ (—Å–≤–µ–∂–∏–π): " lst-names nil t) lst))))
    (when (and a b (file-exists-p a) (file-exists-p b))
      (ediff-files a b))))

;;;; === ‚Äú–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏‚Äù: –ø–æ–∏—Å–∫ –Ω–æ–≤—ã—Ö —Ç–µ–º ===

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--log-get-words (log-file)
  "–ò–∑–≤–ª–µ—á—å —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ –∏–∑ LOG-FILE –¥–ª—è –º–µ—Ç–∞-–∞–Ω–∞–ª–∏–∑–∞."
  (when (and log-file (file-readable-p log-file))
    (with-temp-buffer
      (insert-file-contents log-file)
      (let* ((txt (buffer-string))
             (words (split-string
                     (downcase (replace-regexp-in-string "[^a-z–∞-—è—ë0-9_-]+" " " txt))
                     " +" t)))
        (delete-dups (cl-remove-if (lambda (w) (< (length w) 4)) words))))))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--log-recent-files (n &optional —Å—Ü–µ–Ω–∞—Ä–∏–π)
  "–ü–æ—Å–ª–µ–¥–Ω–∏–µ N –ª–æ–≥-—Ñ–∞–π–ª–æ–≤, –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—é –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω."
  (let* ((lst (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–ª–æ–≥-—Ñ–∞–π–ª—ã —Å—Ü–µ–Ω–∞—Ä–∏–π))
         (sorted (sort lst (lambda (a b) (string> (cdr a) (cdr b))))))
    (mapcar #'cdr (cl-subseq sorted 0 (min n (length sorted))))))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å-–Ω–æ–≤–æ–µ (&optional current-log n-compare)
  "–°—Ä–∞–≤–Ω–∏—Ç—å CURRENT-LOG (–∏–ª–∏ –Ω–æ–≤—ã–π) —Å N-COMPARE –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏: –Ω–∞–π—Ç–∏ –Ω–æ–≤—ã–µ —Ç–µ–º—ã."
  (let* ((cur-log (or current-log (car (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--log-recent-files 1))))
         (prev-logs (cdr (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--log-recent-files (or n-compare 8))))
         (cur-words (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--log-get-words cur-log))
         (prev-words (cl-remove-duplicates
                      (apply #'append (mapcar #'–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--log-get-words prev-logs))))
         (stop '( "https" "http" "–≤–µ—Å—Ç" "–Ω–æ–≤–æ—Å—Ç" "–∑–∞–º–µ—á" "—Ä–æ—Å—Å–∏" "–≥–ª–∞–≤–Ω" "–¥–∞—Ç–∞"
                   "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç" "–∞–Ω–∞–ª–∏–∑" "–æ—Ç–≤–µ—Ç" "–ª–æ–≥" "–¥–∞–π–¥–∂–µ—Å—Ç" "–∏–Ω—Ñ–æ" "—Ç–µ–º–∞"))
         (new-words (cl-set-difference cur-words prev-words :test #'equal)))
    (cl-remove-if (lambda (w)
                    (or (member w stop)
                        (string-match-p "^[0-9]+$" w)
                        (< (length w) 4)))
                  new-words)))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/–∏–Ω—Ñ–æ-–º–µ—Å—Å–µ–¥–∂ (&optional cur-log n-compare)
  "–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ —Å–æ–æ–±—â–∞–µ—Ç, –µ—Å–ª–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ —Ç–µ–º—ã."
  (let* ((–Ω–æ–≤—ã–µ (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å-–Ω–æ–≤–æ–µ cur-log n-compare)))
    (when (and –Ω–æ–≤—ã–µ (> (length –Ω–æ–≤—ã–µ) 0))
      (message "‚ÄºÔ∏è –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–æ–≤—ã–µ —Ç–µ–º—ã! ‚Üí %s"
               (string-join (seq-take –Ω–æ–≤—ã–µ 6) ", "))
      –Ω–æ–≤—ã–µ)))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/ai-–æ—Ç—á–µ—Ç (&optional cur-log n-compare)
  "–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç AI-–æ—Ç—á—ë—Ç ‚Äî —á—Ç–æ –ø–æ—è–≤–∏–ª–æ—Å—å –Ω–æ–≤–æ–≥–æ, –∫–∞–∫–æ–≤ —Ç—Ä–µ–Ω–¥."
  (interactive)
  (let* ((recent (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--log-recent-files (or n-compare 8)))
         (cur-log (or cur-log (car recent)))
         (prev-logs (cdr recent)))
    (if (not cur-log)
        (message "–ù–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –ª–æ–≥–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è AI-–æ—Ç—á—ë—Ç–∞.")
      (let* ((—Å—Ç–∞—Ä–æ–µ (if prev-logs
                         (mapconcat (lambda (f) (with-temp-buffer
                                                 (insert-file-contents f)
                                                 (buffer-string)))
                                    prev-logs "\n\n---\n\n")
                       "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö"))
             (–Ω–æ–≤–æ–µ (if (and cur-log (file-readable-p cur-log))
                        (with-temp-buffer
                          (insert-file-contents cur-log)
                          (buffer-string))
                      "–Ω–µ—Ç —Å–≤–µ–∂–∏—Ö –ª–æ–≥–æ–≤"))
             (–ø—Ä–æ–º–ø—Ç "–°—Ä–∞–≤–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π. –í—ã–¥–µ–ª–∏ –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞, —Ç–µ–º—ã –∏ –ª–∞–∫–æ–Ω–∏—á–Ω–æ –æ–ø–∏—à–∏ –Ω–æ–≤—ã–µ —Ç—Ä–µ–Ω–¥—ã –∏ —Ä–∏—Å–∫–∏."))
        (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–æ—Ç–ø—Ä–∞–≤–∏—Ç—å-via-gptel
         `(("–ù–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞" . "")
           ("–°—Ç–∞—Ä—ã–µ –æ—Ç—á–µ—Ç—ã:" . ""))
         (concat –ø—Ä–æ–º–ø—Ç
                 "\n---\n–°–≤–µ–∂–∏–π –ª–æ–≥:\n" –Ω–æ–≤–æ–µ
                 "\n---\n–õ–æ–≥–∏ –ø—Ä–æ—à–ª—ã—Ö –¥–Ω–µ–π:\n" —Å—Ç–∞—Ä–æ–µ))))))

;;; --- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å gptel post-response ---

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--after-ai (beg end)
  "–õ–æ–≥–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ—Å–ª–µ AI –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏."
  (let ((response (buffer-substring-no-properties beg end)))
    (when (and (boundp '–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ª–æ–≥-–∫–æ–Ω—Ç–µ–∫—Å—Ç)
               –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ª–æ–≥-–∫–æ–Ω—Ç–µ–∫—Å—Ç)
      (let* ((params –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ª–æ–≥-–∫–æ–Ω—Ç–µ–∫—Å—Ç)
             (–∑–∞–≥–æ–ª–æ–≤–∫–∏ (plist-get params :–∑–∞–≥–æ–ª–æ–≤–∫–∏))
             (–ø—Ä–æ–º–ø—Ç (plist-get params :–ø—Ä–æ–º–ø—Ç))
             (meta (plist-get params :meta)))
        (let ((log-file (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–æ–º–ø—Ç response meta)))
          (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/–∏–Ω—Ñ–æ-–º–µ—Å—Å–µ–¥–∂ log-file 7)
          (setq-local –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ª–æ–≥-–∫–æ–Ω—Ç–µ–∫—Å—Ç nil))))))

(add-hook 'gptel-post-response-functions #'–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--after-ai)

;;;; === –ú–µ–Ω—é: –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã (—Å –∏–∫–æ–Ω–∫–∞–º–∏) ===

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–≤—Å–µ-—Å—Ü–µ–Ω–∞—Ä–∏–∏-menu-list ()
  "–°–æ–±–∏—Ä–∞–µ—Ç –º–µ–Ω—é –∫–æ–º–∞–Ω–¥ –∏–∑ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ —É—Ç–∏–ª–∏—Ç (—Å –∏–∫–æ–Ω–∫–∞–º–∏)."
  (let* ((main-icons
          '(("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∑–∞-—á–∞—Å"         . "‚≠ê")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∑–∞-–¥–µ–Ω—å"        . "‚≠ê")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–≥–∏–∫"            . "‚≠ê")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∫—Ä–∞—Ç–∫–æ"         . "‚≠ê")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Ñ–∏–Ω–∞–Ω—Å—ã"        . "üì∞")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–≥–ª—É–±–æ–∫–æ"        . "üß†")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—é–º–æ—Ä"           . "ü§£")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Ç–µ–º—ã-—Ä–∞–¥–∞—Ä–∞"    . "üåê")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–≤–æ–ø—Ä–æ—Å—ã-–æ—Ç–≤–µ—Ç—ã" . "‚ùì")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–º–µ–Ω—é-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç" . "üö¶")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–≤—ã–±—Ä–∞—Ç—å"   . "üìú")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–ø–æ—Å–ª–µ–¥–Ω–∏–µ" . "üìú")
            ("–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/diff"      . "üìä")
            )))
    (let ((cmds '()))
      (mapatoms
       (lambda (sym)
         (when (and (commandp sym)
                    (string-prefix-p "–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-" (symbol-name sym)))
           (let* ((name (symbol-name sym))
                  (icon (or (cdr (assoc name main-icons)) "üì∞"))
                  (doc (or (documentation sym t) "–Ω–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è"))
                  (lbl (format "%s %s ‚Äî %s" icon
                               (replace-regexp-in-string
                                "-" " "
                                (string-remove-prefix "–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-" name))
                               (replace-regexp-in-string "\n.*" "" doc))))
             (push (cons lbl sym) cmds))))
       obarray)
      ;; –î–æ–ø. —É—Ç–∏–ª–∏—Ç—ã, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é
      (dolist (it '(("üìú –ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: –≤—ã–±—Ä–∞—Ç—å –∑–∞–ø–∏—Å—å"    . –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–≤—ã–±—Ä–∞—Ç—å)
                    ("üìú –ü–æ—Å–ª–µ–¥–Ω–∏–µ N –ª–æ–≥–æ–≤ (–æ—Ç–∫—Ä–æ–µ—Ç –æ–∫–Ω–∞)"    . –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/–ø–æ—Å–ª–µ–¥–Ω–∏–µ)
                    ("üìä –°—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞ —Å—Ä–µ–∑–∞ (diff)"           . –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∏—Å—Ç–æ—Ä–∏—è/diff)
                    ("üö¶ –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"            . –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–º–µ–Ω—é-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç)))
        (push it cmds))
      (sort cmds (lambda (a b) (string< (car a) (car b)))))))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–º–µ–Ω—é ()
  "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é: –±—ã—Å—Ç—Ä–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–ª–∏ —É—Ç–∏–ª–∏—Ç—É –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏."
  (interactive)
  (let* ((cmds (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–≤—Å–µ-—Å—Ü–µ–Ω–∞—Ä–∏–∏-menu-list))
         (labels (mapcar #'car cmds))
         (choice (completing-read "–ü—Ä–æ-–ù–æ–≤–æ—Å—Ç–∏: –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π ‚Üí " labels nil t))
         (fun    (cdr (assoc choice cmds))))
    (if fun
        (call-interactively fun)
      (message "‚è∏Ô∏è –≠—Ç–æ –Ω–µ –∫–æ–º–∞–Ω–¥–∞."))))

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏/–º–µ–Ω—é-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç ()
  "–ú–µ–Ω—é –∞–Ω–∞–ª–∏–∑–∞ –Ω–æ–≤—ã—Ö —Ç–µ–º: –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏."
  (interactive)
  (let* ((opts '("–ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞/—Ç–µ–º—ã (–∑–∞ –Ω–µ–¥–µ–ª—é)"
                 "AI-–æ—Ç—á–µ—Ç –ø–æ —Å–≤–µ–∂–∏–º –æ—Ç–ª–∏—á–∏—è–º"
                 "–í—ã—Ö–æ–¥"))
         (choice (completing-read "–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî —á—Ç–æ —Å–¥–µ–ª–∞—Ç—å? " opts nil t)))
    (cond
     ((string= choice "–ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞/—Ç–µ–º—ã (–∑–∞ –Ω–µ–¥–µ–ª—é)")
      (let ((lst (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å-–Ω–æ–≤–æ–µ nil 7)))
        (if lst
            (message "‚ÄºÔ∏è –ù–æ–≤—ã–µ —Ç–µ–º—ã: %s" (string-join lst ", "))
          (message "–ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–µ–º!"))))
     ((string= choice "AI-–æ—Ç—á–µ—Ç –ø–æ —Å–≤–µ–∂–∏–º –æ—Ç–ª–∏—á–∏—è–º")
      (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç/ai-–æ—Ç—á–µ—Ç))
     (t (message "–û—Ç–º–µ–Ω–µ–Ω–æ.")))))

;;;; === –ì–æ—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—Å) ===

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∑–∞-—á–∞—Å
 "–ë—ã—Å—Ç—Ä—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ 1 —á–∞—Å (–¥–æ 25 —à—Ç—É–∫)."
 :—á–∞—Å–æ–≤ 1 :–º–∞–∫—Å–∏–º—É–º 25
 :–ø—Ä–æ–º–ø—Ç "–ö—Ä–∞—Ç–∫–æ –∏–∑–ª–æ–∂–∏ –≤—Å—ë –ø–æ —Ç–µ–º–∞–º. –ï—Å–ª–∏ –µ—Å—Ç—å –≤–µ—Å—ë–ª–æ–µ ‚Äî –æ—Ç–º–µ—Ç—å. –ï—Å–ª–∏ —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è —Ç—Ä–µ–Ω–¥ ‚Äî –∫—Ä–∞—Ç–∫–æ –ø–æ–¥—á–µ—Ä–∫–Ω–∏.")

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∑–∞-–¥–µ–Ω—å
 "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –Ω–æ–≤–æ—Å—Ç–Ω–æ–π –æ–±–∑–æ—Ä –∑–∞ 12 —á–∞—Å–æ–≤ (–¥–æ 40)."
 :—á–∞—Å–æ–≤ 12 :–º–∞–∫—Å–∏–º—É–º 40
 :–ø—Ä–æ–º–ø—Ç "–°–¥–µ–ª–∞–π –æ–±–∑–æ—Ä –±–µ–∑ –≤–æ–¥—ã, –±–µ–∑ –¥—É–±–ª–µ–π ‚Äî —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã–µ –∏ –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è. –ö—Ä–∞—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ç–æ–ª—å–∫–æ —Å—É—Ç—å –∏ –æ–±—â–∏–π –≤—ã–≤–æ–¥.")

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Ñ–∏–Ω–∞–Ω—Å—ã
 "–í—Å–µ —Å–≤–µ–∂–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∑–∞ —Å—É—Ç–∫–∏."
 :—á–∞—Å–æ–≤ 24 :–º–∞–∫—Å–∏–º—É–º 30
 :–ø—Ä–æ–º–ø—Ç "–°–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä—É–π—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∫—Ä—É–ø–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤, –±–∞–Ω–∫–æ–≤, –±–∏—Ä–∂, –∫—Ä–∏–ø—Ç–æ –∏ –º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏–∫–∏. –ò–∑–ª–æ–∂–∏ —Å—Ç—Ä–æ–≥–æ, –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ."
 :—Ñ–∏–ª—å—Ç—Ä "—Ñ–∏–Ω–∞–Ω—Å\\|–±–∞–Ω–∫\\|–±–∏—Ä–∂\\|—ç–∫–æ–Ω–æ–º\\|–∫—Ä–∏–ø—Ç")

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–≥–∏–∫
 "–ê–π—Ç–∏/–Ω–∞—É–∫–∞/—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ ‚Äî –≥–∏–∫-–¥–∞–π–¥–∂–µ—Å—Ç –∑–∞ 24—á."
 :—á–∞—Å–æ–≤ 24 :–º–∞–∫—Å–∏–º—É–º 40 :—Å—Å—ã–ª–∫–∏ t
 :–ø—Ä–æ–º–ø—Ç "–í—ã–±–µ—Ä–∏ —Ç–æ–ª—å–∫–æ –Ω–∞—É—á–Ω—ã–µ, IT, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏–ª–∏ Linux/AI –Ω–æ–≤–æ—Å—Ç–∏. –ï—Å–ª–∏ –µ—Å—Ç—å –∑–Ω–∞—á–∏–º—ã–µ –∞–Ω–æ–Ω—Å—ã/—Å–æ—Ñ—Ç ‚Äî –≤—ã–¥–µ–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ."
 :—Ñ–∏–ª—å—Ç—Ä "–ò–ò\\|AI\\|—Ç–µ—Ö–Ω–æ–ª\\|–Ω–∞—É–∫\\|—Ä–∞–∑—Ä–∞–±–æ—Ç–∫\\|Linux\\|–∞–ª–≥–æ—Ä–∏—Ç–º\\|–≥–∞–¥–∂–µ—Ç")

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–∫—Ä–∞—Ç–∫–æ
 "AI-–∫–æ–º–ø–∞–∫—Ç: —Ç–æ–ø-5 —Å–æ–±—ã—Ç–∏–π –¥–Ω—è ‚Äî —Å—Ä–∞–∑—É —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ."
 :—á–∞—Å–æ–≤ 24 :–º–∞–∫—Å–∏–º—É–º 30
 :–ø—Ä–æ–º–ø—Ç "–ö—Ä–∞—Ç–∫–æ –∏ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ: –≤—ã–±–µ—Ä–∏ 4-6 –≥–ª–∞–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è –¥–Ω—è, –Ω–∞ –∫–∞–∂–¥–æ–µ –¥–∞–π 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ—è—Å–Ω–µ–Ω–∏—è. –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥ ‚Äî —Ç—Ä–µ–Ω–¥ –¥–Ω—è.")

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Ç–µ–º—ã-—Ä–∞–¥–∞—Ä–∞
 "–ò–Ω—Ñ–æ—Ä–∞–¥–∞—Ä: –ß–¢–û —á–∞—â–µ –≤—Å–µ–≥–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ RSS –∑–∞ 24 —á–∞—Å–∞."
 :—á–∞—Å–æ–≤ 24 :–º–∞–∫—Å–∏–º—É–º 60
 :–ø—Ä–æ–º–ø—Ç "–í—ã–¥–µ–ª–∏ –≤—Å–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∏–ª–∏ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è —Ç–µ–º—ã, —É–ø–æ—Ä—è–¥–æ—á–∏ –∏—Ö –ø–æ —á–∞—Å—Ç–æ—Ç–µ. –ü–æ–∫–∞–∂–∏ –ø–æ –∫–∞–∂–¥–æ–π —Ç–µ–º–µ ‚Äî –∫–æ—Ä–æ—Ç–∫–æ —Å—É—Ç—å, –∫—Ç–æ —É—á–∞—Å—Ç–≤—É–µ—Ç, –ø–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ.")

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–≤–æ–ø—Ä–æ—Å—ã-–æ—Ç–≤–µ—Ç—ã
 "Q&A –ø–æ –ª–µ–Ω—Ç–∞–º —Å—É—Ç–æ–∫."
 :—á–∞—Å–æ–≤ 24 :–º–∞–∫—Å–∏–º—É–º 30
 :–ø—Ä–æ–º–ø—Ç "–î–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ—Å—Ç–∏ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å (—á—Ç–æ, –∫—Ç–æ, –ø–æ—á–µ–º—É). –°—Ä–∞–∑—É –¥–∞–π –∫—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∏ —Ç—Ä–µ–Ω–¥–µ. –ö—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.")

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—é–º–æ—Ä
 "–ü–æ–ø—Ä–æ–±—É–π –æ–±–µ—Ä–Ω—É—Ç—å —Å–æ–±—ã—Ç–∏—è –¥–Ω—è –≤ –∏—Ä–æ–Ω–∏—á–Ω—ã–π –∏–ª–∏ —é–º–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –¥–∞–π–¥–∂–µ—Å—Ç."
 :—á–∞—Å–æ–≤ 24 :–º–∞–∫—Å–∏–º—É–º 30
 :–ø—Ä–æ–º–ø—Ç "–°–æ—Å—Ç–∞–≤—å —é–º–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –¥–∞–π–¥–∂–µ—Å—Ç: –ø–µ—Ä–µ—Å–∫–∞–∂–∏ –Ω–æ–≤–æ—Å—Ç–∏ –¥–Ω—è —Å –ª—ë–≥–∫–æ–π –∏—Ä–æ–Ω–∏–µ–π, –ø–æ–¥–±—Ä–æ—Å—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–º–µ—à–Ω–æ–π –≤—ã–≤–æ–¥ –∏–ª–∏ –º–µ–º, –Ω–æ –Ω–µ —Ç–µ—Ä—è–π —Å—É—Ç–∏ —Å–æ–±—ã—Ç–∏–π.")

(–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-—Å—Ü–µ–Ω–∞—Ä–∏–π
 –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–≥–ª—É–±–æ–∫–æ
 "AI-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞: –¥–∞–π –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ —Å–≤—è–∑–∏ –∏ –ø—Ä–æ–≥–Ω–æ–∑—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 2 —Å—É—Ç–æ–∫."
 :—á–∞—Å–æ–≤ 48 :–º–∞–∫—Å–∏–º—É–º 60
 :–ø—Ä–æ–º–ø—Ç "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏: –Ω–∞–π–¥–∏ —Å–∫—Ä—ã—Ç—ã–µ —Ç—Ä–µ–Ω–¥—ã, –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ç–µ–º—ã, –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏. –ö—Ä–∞—Ç–∫–æ —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–π –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ —Ç–µ–º –≤ –±–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏/–Ω–µ–¥–µ–ª–∏.")

;;;; === –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ –≤—ã–±–æ—Ä—É ===

(defun –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–≤—ã–±—Ä–∞—Ç—å-–∏-–æ—Ç–ø—Ä–∞–≤–∏—Ç—å (—á–∞—Å–æ–≤ regexp –º–∞–∫—Å–∏–º—É–º –ø—Ä–æ–º–ø—Ç links)
  "–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–æ–±—Ä–∞—Ç—å –¥–∞–π–¥–∂–µ—Å—Ç –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ gptel.
 - –ß–ê–°–û–í –Ω–∞–∑–∞–¥, REGEXP (—Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –≤—Å–µ), –ú–ê–ö–°–ò–ú–£–ú, –ü–†–û–ú–ü–¢, LINKS."
  (interactive
   (list (read-number "–ß–∞—Å–æ–≤ –Ω–∞–∑–∞–¥: " 24)
         (read-string  "–§–∏–ª—å—Ç—Ä (regexp, –ø—É—Å—Ç–æ = –≤—Å–µ): " "")
         (read-number  "–ú–∞–∫—Å–∏–º—É–º –Ω–æ–≤–æ—Å—Ç–µ–π: " 30)
         (read-string  "–ü—Ä–æ–º–ø—Ç –¥–ª—è AI (Enter ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç): ")
         (y-or-n-p     "–í–∫–ª—é—á–∏—Ç—å —Å—Å—ã–ª–∫–∏? ")))
  (let* ((—Å–µ–∫—É–Ω–¥ (* 3600 —á–∞—Å–æ–≤))
         (ai-–ø—Ä–æ–º–ø—Ç (unless (string-empty-p –ø—Ä–æ–º–ø—Ç) –ø—Ä–æ–º–ø—Ç)))
    (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ø–æ–ª—É—á–∏—Ç—å-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
     —Å–µ–∫—É–Ω–¥
     (lambda (chunk)
       ;; –í–ê–ñ–ù–û: —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ elfeed-entry-–æ–±—ä–µ–∫—Ç–∞–º, –Ω–µ –ø–æ cons cells!
       (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å
        chunk
        (unless (string-empty-p regexp)
          regexp)))
     (lambda (–Ω–æ–≤–æ—Å—Ç–∏)
       (let ((–∏—Ç–æ–≥ (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏--–ø–∞–∫–µ—Ç
                   (mapcar (lambda (entry)
                             (cons (elfeed-entry-title entry)
                                   (elfeed-entry-link entry)))
                           –Ω–æ–≤–æ—Å—Ç–∏)
                   –º–∞–∫—Å–∏–º—É–º)))
         (if (null –∏—Ç–æ–≥)
             (message "–ù–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –Ω–æ–≤–æ—Å—Ç–µ–π.")
           (–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏-–æ—Ç–ø—Ä–∞–≤–∏—Ç—å-via-gptel –∏—Ç–æ–≥ ai-–ø—Ä–æ–º–ø—Ç links)))))))

(provide '–ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏)
;;; –ø—Ä–æ-–Ω–æ–≤–æ—Å—Ç–∏.el ends here
