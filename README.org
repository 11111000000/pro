#+TITLE: ПРО: Персональное Рабочее Окружение (минимальная версия)
- На базе Emacs+Guix+EXWM, структура: отдельный модуль по задаче.
- Путь: простота, воспроизводимость, Дао-пустота.
- Развёртывание: bash ./init-pro.sh && emacs --init-directory ./pro/.emacs.d

#+BEGIN_SRC bash
guix shell -m manifest.scm --emacs
#+END_SRC

--- Модули лежат в корне каталога, seeds/ для расширений ---

* Быстрый доступ и управление (основные горячие клавиши)
| Клавиша   | Функция         | Описание                                                               |
|-----------+-----------------+------------------------------------------------------------------------|
| C-c s     | Seeds обзор     | Список всех seeds с кратким описанием                                   |
| C-c h     | Диагностика     | Диагностика reproducibility, сопоставление manifest/use-package, устаревшее|
| C-c x     | Уборка          | Удаление устаревших seeds, undo, recentf                                |
| C-c o     | Main Org        | Открыть/создать главный org-файл (org/main.org)                         |
| C-c n     | Note            | Создать новую заметку в org/notes (через org-roam, либо простую org)    |
| C-c j     | Journal         | Открыть или создать ежедневный журнал (org/journal/YYYY-MM-DD.org)      |
| <f11>     | Zen mode        | Дзен-режим: fullscreen без mode-line, для глубокого фокуса              |
| C-c g     | Guix restart    | Перезапустить Emacs через guix shell (для reproducibility)              |
| C-c N     | Nix restart     | Перезапустить Emacs через nix develop                                   |
| C-c e     | Env info        | Показать сведения о среде: guix/nix/env/up-to-date                      |
| C-c r     | Recent files    | Быстрый доступ к истории (consult/vertico)                              |

Дополнительно:
| C-c f  | Elfeed           | Открыть RSS-ридер Elfeed                        |
| C-c t  | VTerm            | Терминал в новой вкладке, если установлен       |
| C-c M  | Math Scratch     | Создать org-файл для быстрых вычислений         |
| C-c C  | Calendar         | Открыть календарь                               |
| C-c m  | Почта            | Открыть mu4e (почта), если установлен           |

EXWM/глобальные:
| PRO2_EXWM=1 emacs .../ --with-exwm |   | Запуск Emacs как оконного менеджера (EXWM/xim)   |

Подробные биндинги и расширение смотрите в seeds/про-keymap.el и про-сочетания-клавиш.org.

* ОПИСАНИЕ ФУНКЦИЙ И SEEDS (важнейшие):

** Система загрузки extension seeds/
- Каждый файл в seeds/ — отдельный seed-модуль (например, про-историю.el, про-journal.el, про-notes.el).
- Загрузка авто и отражается в README-seeds.org.
- Для списка и описания: C-c s (про/list-seeds).

** Диагностика (про-health-check.el, про-поиск-пакетов.el)
- C-c h: Показывает диагностику reproducibility:
  - Чистота окружения (Guix/Nix)
  - Старые/устаревшие seeds
  - Расхождение между use-package в seeds и manifest(.scm/.nix)

** Уборка (про-cleanup.el)
- C-c x: Очищает:
  - seeds старше N дней (интерактивно)
  - undo/history
  - recentf
- Помогает избежать накопления мусора и конфликтов.

** Note & Journal (про-notes.el, про-journal.el)
- C-c n: Создать простую org-заметку/организацию, либо org-roam.
- C-c j: Открыть или создать журнал дня (org/journal/YYYY-MM-DD.org)
- README-notes.org и README-journal.org — символическое описание потока.

** Zen (про-zen-mode.el)
- <f11>: Включает/выключает режим дзен — fullscreen, тишина, нет mode-line.

** Корректный restart с новым окружением:
- C-c g: Перезапустить Emacs в чистом guix shell.
- C-c N: Аналогично — nix develop.
- В seeds/про-запуск-сборки.el.

** Проверка чистоты среды (про-pure-env.el)
- Автоматически проверяет чистоту окружения (Guix/Nix), предупреждает если Emacs стартует вне shell.

** Главный org-файл/main.org
- Всегда доступен через C-c o.
- Можно писать ToDo, рабочие планы, заметки, держать документацию.

** Все рабочие org/ (notes, journal) структурированы:
- org/notes/ для пользовательских заметок
- org/journal/ для ежедневников
- README-notes.org и README-journal.org — короткие инструкции по использованию

* Совместимость с Guix и Nix

** Guix:
   Развёртывание/запуск:
   #+BEGIN_SRC sh
   guix shell -m manifest.scm -- emacs --init-directory ./pro2/.emacs.d
   #+END_SRC

** Nix/NixOS:
   Развёртывание:
   #+BEGIN_SRC sh
   nix develop nix/manifest.nix -c emacs --init-directory ./pro2/.emacs.d
   #+END_SRC

** Чистота окружения:
   - Автоматически проверяется в seeds/про-pure-env.el (GUIX_ENVIRONMENT или IN_NIX_SHELL).
   - Если не в shell, появляется предупреждение.

* Как расширять функциональность:

1. Добавьте use-package в manifest.scm (Guix) или manifest.nix (Nix).
2. Создайте новый seed в seeds/про-<имя>.el с конфигом use-package.
3. Для теста — C-c s (список), C-c h (диагностика).
4. Всё новое — только по необходимости!

* FAQ (см. INSTALL.org):

- EXWM/оконный WM: только при запуске с PRO2_EXWM=1 или --with-exwm.
- Как добавить seed? Просто создать файл .el в seeds/.
- Как обновить? git pull && guix pull && guix shell …
- Как очистить? C-c x.
- Любую функцию можно отключить убрав или переименовав seed-файл.
